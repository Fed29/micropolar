var micropolar={version:"0.2.1"},µ=micropolar;µ.Axis=function(){function t(){var i=a.data,o=a.layout,l=o.container;return("string"==typeof l||l.nodeName)&&(l=d3.select(l)),l.datum(i).each(function(t){function a(t){return r(t)%360+o.orientation}var i=t.slice();f=i.filter(function(t){var e=t.visible;return"undefined"==typeof e||e===!0});var l=!1,s=f.map(function(t){return l=l||"undefined"!=typeof t.groupId,t});if(l){var c=d3.nest().key(function(t){return"undefined"!=typeof t.groupId?t.groupId:"unstacked"}).entries(s),u=[],d=c.map(function(t){if("unstacked"===t.key)return t.values;var e=t.values[0].y.map(function(){return 0});return t.values.forEach(function(t){t.yStack=[e],u.push(e),e=µ.util.sumArrays(t.y,e)}),t.values});f=d3.merge(d)}var g,f=f.map(function(t){var e=t;return e.name=t.name,e.x=Array.isArray(t.x[0])?t.x:[t.x],e.y=Array.isArray(t.y[0])?t.y:[t.y],e.yStack=t.yStack,e}),p=Math.min(o.width-o.margin.left-o.margin.right,o.height-o.margin.top-o.margin.bottom)/2,y=[o.margin.left+p,o.margin.top+p];if(l){var m=d3.max(µ.util.sumArrays(µ.util.arrayLast(f).y[0],µ.util.arrayLast(u)));g=[0,m]}else g=d3.extent(µ.util.flattenArray(f.map(function(t){return t.y})));n=d3.scale.linear().domain(o.radialAxis.domain||g).range([0,p]);var h,v=µ.util.flattenArray(f.map(function(t){return t.x})),x="string"==typeof v[0];x&&(v=µ.util.deduplicate(v),h=v.slice(),v=d3.range(v.length),f=f.map(function(t){var e=t;return t.x=[v],l&&(e.yStack=t.yStack),e}));var k=d3.extent(v),b=o.angularAxis.domain?o.angularAxis.domain.slice():k,C=v[1]-v[0];o.needsEndSpacing&&(b[1]+=C);var A=o.angularAxis.ticksCount||4;A>8&&(A=A/(A/8)+A%8),o.angularAxis.ticksStep&&(A=(b[1]-b[0])/A);var S=o.angularAxis.ticksStep||(b[1]-b[0])/(A*(o.minorTicks+1));b[2]||(b[2]=S);var w=d3.range.apply(this,b);if(w=w.map(function(t){return parseFloat(t.toPrecision(12))}),r=d3.scale.linear().domain(b.slice(0,2)).range("clockwise"===o.direction?[0,360]:[360,0]),r.endPadding=o.needsEndSpacing?C:0,e=d3.select(this).select("svg.chart-root"),"undefined"==typeof e||e.empty()){var z='<svg xmlns="http://www.w3.org/2000/svg" class="chart-root"><g class="outer-group"><g class="chart-group"><circle class="background-circle"></circle><g class="geometry-group"></g><g class="radial axis-group"><circle class="outside-circle"></circle></g><g class="angular axis-group"></g><g class="guides-group"><line></line><circle r="0"></circle></g></g><g class="legend-group"></g><g class="tooltips-group"></g><g class="title-group"><text></text></g></g></svg>',L=(new DOMParser).parseFromString(z,"application/xml"),P=this.appendChild(this.ownerDocument.importNode(L.documentElement,!0));e=d3.select(P)}var T={fill:"none",stroke:o.tickColor},E={"font-size":o.font.size,"font-family":o.font.family,fill:o.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(t){return" "+t+" 0 "+o.font.outlineColor}).join(",")};e.attr({width:o.width,height:o.height}).style({opacity:o.opacity});var M=e.select(".chart-group").attr("transform","translate("+y+")").style({cursor:"crosshair"});e.select(".guides-group").style({"pointer-events":"none"}),e.select(".angular.axis-group").style({"pointer-events":"none"}),e.select(".radial.axis-group").style({"pointer-events":"none"});var I=e.select(".radial.axis-group");if(o.radialAxis.gridLinesVisible){var O=I.selectAll("circle.grid-circle").data(n.ticks(5));O.enter().append("circle").attr({"class":"grid-circle"}).style(T),O.attr("r",n),O.exit().remove()}I.select("circle.outside-circle").attr({r:p}).style(T);var B=e.select("circle.background-circle").attr({r:p}).style({fill:o.backgroundColor,stroke:o.stroke});if(o.radialAxis.visible){var R=d3.svg.axis().scale(n).ticks(5).tickSize(5);I.call(R).attr({transform:"rotate("+o.radialAxis.orientation+")"}),I.selectAll(".domain").style(T),I.selectAll("g>text").text(function(){return this.textContent+o.radialAxis.ticksSuffix}).style(E).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(){return"horizontal"===o.radialAxis.tickOrientation?"rotate("+-o.radialAxis.orientation+") translate("+[0,E["font-size"]]+")":"translate("+[0,E["font-size"]]+")"}}),I.selectAll("g>line").style({stroke:"black"})}var V=e.select(".angular.axis-group").selectAll("g.angular-tick").data(w),q=V.enter().append("g").classed("angular-tick",!0);V.attr({transform:function(t,e){return"rotate("+a(t,e)+")"}}).style({display:o.angularAxis.visible?"block":"none"}),V.exit().remove(),q.append("line").classed("grid-line",!0).classed("major",function(t,e){return 0==e%(o.minorTicks+1)}).classed("minor",function(t,e){return!(0==e%(o.minorTicks+1))}).style(T),q.selectAll(".minor").style({stroke:o.minorTickColor}),V.select("line.grid-line").attr({x1:o.tickLength?p-o.tickLength:0,x2:p}).style({display:o.angularAxis.gridLinesVisible?"block":"none"}),q.append("text").classed("axis-text",!0).style(E);var W=V.select("text.axis-text").attr({x:p+o.labelOffset,dy:".35em",transform:function(t,e){var n=a(t,e),r=p+o.labelOffset,i=o.angularAxis.tickOrientation;return"horizontal"==i?"rotate("+-n+" "+r+" 0)":"radial"==i?270>n&&n>90?"rotate(180 "+r+" 0)":null:"rotate("+(180>=n&&n>0?-90:90)+" "+r+" 0)"}}).style({"text-anchor":"middle",display:o.angularAxis.labelsVisible?"block":"none"}).text(function(t,e){return 0!=e%(o.minorTicks+1)?"":h?h[e/(o.minorTicks+1)]+o.angularAxis.ticksSuffix:t+o.angularAxis.ticksSuffix}).style(E);o.angularAxis.rewriteTicks&&W.text(function(t,e){return 0!=e%(o.minorTicks+1)?"":o.angularAxis.rewriteTicks(this.textContent,e)});var j=e.select("g.geometry-group").selectAll("g").size()>0;if(f[0]||j){var D=0,F=[];i.forEach(function(t){t.color||(t.color=o.defaultColorRange[D],D=(D+1)%o.defaultColorRange.length)}),f.forEach(function(t,a){var i="geometry"+a,l=e.select("g.geometry-group").selectAll("g."+i).data([0]);l.enter().append("g").classed(i,!0);var s=t;s.radialScale=n,s.angularScale=r,s.container=l,s.orientation||(s.orientation=o.orientation),s.direction=o.direction,s.index=a,F.push({data:f[a],geometryConfig:s})});var _=d3.nest().key(function(t){return t.geometryConfig.groupId||"unstacked"}).entries(F),N=[];_.forEach(function(t){"unstacked"===t.key?N=N.concat(t.values):N.push(t.values)}),N.forEach(function(t){var e;e=Array.isArray(t)?t[0].geometryConfig.geometry:t.geometryConfig.geometry,µ[e]().config(t)()})}if(o.showLegend){var K=d3.max(M.selectAll(".angular-tick text")[0].map(function(t){return t.getCTM().e+t.getBBox().width})),Z=e.select(".legend-group").attr({transform:"translate("+[p+K,o.margin.top]+")"}).style({display:"block"}),G=f.map(function(t){return t.symbol="line",t.visibleInLegend="undefined"==typeof t.visibleInLegend||t.visibleInLegend,t.color=t.color||"black",t}),H=µ.util.deepExtend({},µ.Legend.defaultConfig().legendConfig),J=µ.util.deepExtend(H,{container:Z,elements:G}),Q={data:f.map(function(t,e){return t.name||"Element"+e}),legendConfig:J};µ.Legend().config(Q)()}else e.select(".legend-group").style({display:"none"});if(o.title){var U=e.select("g.title-group text").attr({x:100,y:100}).style(E).text(o.title),X=U.node().getBBox();U.attr({x:o.margin.left+p-X.width/2,y:X.height})}e.select(".geometry-group g").style({"pointer-events":"visible"});var Y,$,te=e.select(".guides-group"),ee=e.select(".tooltips-group"),ne=µ.tooltipPanel().config({container:ee,fontSize:8})(),re=µ.tooltipPanel().config({container:ee,fontSize:8})(),ae=µ.tooltipPanel().config({container:ee,hasTick:!0})();if(!x){var ie=te.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});M.on("mousemove.angular-guide",function(){var t=µ.util.getMousePos(B).angle;ie.attr({x2:-p,transform:"rotate("+t+")"}).style({opacity:.5});var e=(t+360+o.orientation)%360;Y=r.invert(e);var n=µ.util.convertToCartesian(p+12,t+180);ne.text(µ.util.round(Y)).move([n[0]+y[0],n[1]+y[1]])}).on("mouseout.angular-guide",function(){te.select("line").style({opacity:0})})}var oe=te.select("circle").style({stroke:"grey",fill:"none"});M.on("mousemove.radial-guide",function(){var t=µ.util.getMousePos(B).radius;oe.attr({r:t}).style({opacity:.5}),$=n.invert(µ.util.getMousePos(B).radius);var e=µ.util.convertToCartesian(t,o.radialAxis.orientation);re.text(µ.util.round($)).move([e[0]+y[0],e[1]+y[1]])}).on("mouseout.radial-guide",function(){oe.style({opacity:0}),ae.hide(),ne.hide(),re.hide()}),e.selectAll(".geometry-group .mark").on("mouseenter.tooltip",function(t){var n=d3.select(this),r=n.style("fill"),a="black",i=n.style("opacity")||1;if(n.attr({"data-opacity":i}),"none"!=r){n.attr({"data-fill":r}),a=d3.hsl(r).darker().toString(),n.style({fill:a,opacity:1});var o=this.getBoundingClientRect(),l=e.node().getBoundingClientRect(),s=[o.left-l.left+o.width/2-le[0],o.top-l.top+o.height/2-le[1]],c="θ: "+µ.util.round(t[0])+", r: "+µ.util.round(t[1]);ae.config({color:a}).text(c),ae.move(s)}else r=n.style("stroke"),n.attr({"data-stroke":r}),a=d3.hsl(r).darker().toString(),n.style({stroke:a,opacity:1})}).on("mousemove.tooltip",function(){d3.select(this).attr("data-fill")&&ae.show()}).on("mouseout.tooltip",function(){ae.hide();var t=d3.select(this),e=t.attr("data-fill");e?t.style({fill:e,opacity:t.attr("data-opacity")}):t.style({stroke:t.attr("data-stroke"),opacity:t.attr("data-opacity")})});var le=[o.width/2-p-o.margin.left,o.height/2-p-o.margin.top];e.select(".outer-group").attr("transform","translate("+le+")")}),t}var e,n,r,a=µ.Axis.defaultConfig(),i=d3.dispatch("hover");return t.config=function(t){return arguments.length?(µ.util.deepExtend(a,t),this):a},t.radialScale=function(){return n},t.angularScale=function(){return r},t.svg=function(){return e},d3.rebind(t,i,"on"),t},µ.Axis.defaultConfig=function(){var t={data:[{x:[1,2,3,4],y:[10,11,12,13],name:"Line1",geometry:"LineChart",color:"limegreen",visibleInLegend:!0,opacity:1},{x:[21,22,23,24],y:[30,31,32,33],name:"Line2",geometry:"LineChart"}],layout:{defaultColorRange:d3.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:31,color:"red",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:null,ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:1,tickLength:null,tickColor:"silver",minorTickColor:"#eee",container:"body",backgroundColor:"none",needsEndSpacing:!0,showLegend:!0,opacity:1}};return t},µ.util={},µ.util._override=function(t,e){for(var n in t)n in e&&(e[n]=t[n])},µ.util._extend=function(t,e){for(var n in t)e[n]=t[n]},µ.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},µ.util.dataFromEquation2=function(t,e){var n=e||6,r=d3.range(0,360+n,n).map(function(e){var n=e*Math.PI/180,r=t(n);return[e,r]});return r},µ.util.dataFromEquation=function(t,e,n){var r=e||6,a=[],i=[];d3.range(0,360+r,r).forEach(function(e){var n=e*Math.PI/180,r=t(n);a.push(e),i.push(r)});var o={x:a,y:i};return n&&(o.name=n),o},µ.util.ensureArray=function(t,e){if("undefined"==typeof t)return null;var n=[].concat(t);return d3.range(e).map(function(t,e){return n[e]||n[0]})},µ.util.fillArrays=function(t,e,n){return e.forEach(function(e){t[e]=µ.util.ensureArray(t[e],n)}),t},µ.util.deepExtend=function(t,e){for(var n in e)e[n]&&e[n].constructor&&e[n].constructor===Object?(t[n]=t[n]||{},arguments.callee(t[n],e[n])):t[n]=e[n];return t},µ.util.validateKeys=function(t,e){"string"==typeof e&&(e=e.split("."));var n=e.shift();return t[n]&&(!e.length||objHasKeys(t[n],e))},µ.util.sumArrays=function(t,e){return d3.zip(t,e).map(function(t){return d3.sum(t)})},µ.util.arrayLast=function(t){return t[t.length-1]},µ.util.arrayEqual=function(t,e){for(var n=Math.max(t.length,e.length,1);n-->=0&&t[n]===e[n];);return-2===n},µ.util.flattenArray=function(t){for(var e=[];!µ.util.arrayEqual(e,t);)e=t,t=[].concat.apply([],t);return t},µ.util.deduplicate=function(t){return t.filter(function(t,e,n){return n.indexOf(t)==e})},µ.util.convertToCartesian=function(t,e){var n=e*Math.PI/180,r=t*Math.cos(n),a=t*Math.sin(n);return[r,a]},µ.util.round=function(t,e){var n=e||2,r=Math.pow(10,n);return Math.round(t*r)/r},µ.util.getMousePos=function(t){var e=d3.mouse(t.node()),n=e[0],r=e[1],a={};return a.x=n,a.y=r,a.pos=e,a.angle=180*(Math.atan2(r,n)+Math.PI)/Math.PI,a.radius=Math.sqrt(n*n+r*r),a},µ.util.duplicatesCount=function(t){for(var e,n={},r={},a=0,i=t.length;i>a;a++)e=t[a],e in n?(n[e]++,r[e]=n[e]):n[e]=1;return r},µ.util.duplicates=function(t){return Object.keys(µ.util.duplicatesCount(t))},µ.util.translator=function(t,e,n,r){if(r){var a=n.slice();n=e,e=a}var i=e.reduce(function(t,e){return"undefined"!=typeof t?t[e]:void 0},t);"undefined"!=typeof i&&(e.reduce(function(t,n,r){return"undefined"!=typeof t?(r===e.length-1&&delete t[n],t[n]):void 0},t),n.reduce(function(t,e,r){return"undefined"==typeof t[e]&&(t[e]={}),r===n.length-1&&(t[e]=i),t[e]},t))},µ.PolyChart=function(){function t(){var t=n.geometryConfig,r=t.container;"string"==typeof r&&(r=d3.select(r)),r.datum(n.data).each(function(n){function r(e){var n=t.radialScale(e[1]),r=(t.angularScale(e[0])+t.orientation)*Math.PI/180;return{r:n,θ:r}}function i(t){var e=t.r*Math.cos(t.θ),n=t.r*Math.sin(t.θ);return{x:e,y:n}}console.log(t);var o=!!n.yStack,l=n.y.map(function(t,e){return o?d3.zip(n.x[0],t,n.yStack[e]):d3.zip(n.x[0],t)}),s=t.angularScale,c=t.angularScale.copy().range(t.angularScale.range().slice().reverse()),u="clockwise"===t.direction?s:c,d={},g=t.radialScale.domain()[0];d.bar=function(e){var n=t.radialScale(e[1]),r=t.radialScale(g+(e[2]||0));t.barRadialOffset&&(r=190,n-=r);var a=t.barWidth;return"M"+[[n+r,-a/2],[n+r,a/2],[r,a/2],[r,-a/2]].join("L")+"Z"},d.dot=function(e,n){return d3.svg.symbol().size(t.dotSize).type(t.dotType)(e,n)},d.arc=d3.svg.arc().startAngle(function(){return-f+Math.PI/2}).endAngle(function(){return f+Math.PI/2}).innerRadius(function(e){return t.radialScale(g+(e[2]||0))}).outerRadius(function(e){return t.radialScale(g+(e[2]||0))+t.radialScale(e[1])}),e=function(e){return[].concat(t.color)[e]};var f=u(l[0][1][0])*Math.PI/180/2,p={fill:function(t,n,r){return e(r)},stroke:t.strokeColor,"stroke-width":t.strokeSize+"px","stroke-dasharray":a[t.dash],opacity:t.opacity,display:t.visible?"block":"none"},y=d3.select(this).classed("stacked-area-chart",!0),m=y.selectAll("g.layer").data(l);m.enter().append("g").classed("layer",!0);var h=m.selectAll("path.mark").data(function(t){return t});h.enter().append("path").attr({"class":"mark"}),h.attr({d:d[t.geometryType],transform:"dot"===t.geometryType?function(t){var e=i(r(t));return"translate("+[e.x,e.y]+")"}:function(e){return"rotate("+(t.orientation+s(e[0]))+")"}}).style(p)})}var e,n=µ.PolyChart.defaultConfig(),r=d3.dispatch("hover"),a={solid:"none",dash:[5,2],dot:[2,5]};return t.config=function(t){if(!arguments.length)return n;var e=t;return Array.isArray(t)&&(e=t[0],e.data.y=t.map(function(t){return t.data.y[0]}),e.data.yStack=t.map(function(t){return t.data.yStack[0]}),e.geometryConfig.color=t.map(function(t){return t.geometryConfig.color})),µ.util.deepExtend(n,e),this},t.getColorScale=function(){return e},d3.rebind(t,r,"on"),t},µ.PolyChart.defaultConfig=function(){var t={data:{name:"geom1",x:[[1,2,3,4]],y:[[1,2,3,4]]},geometryConfig:{geometry:"LinePlot",geometryType:"arc",dotType:"circle",dotSize:64,barRadialOffset:null,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",dash:"solid",direction:"clockwise",orientation:0,container:"body",opacity:1,radialScale:null,angularScale:null,index:0,visible:!0,visibleInLegend:!0,colorScale:d3.scale.category20()}};return t},µ.BarChart=function(){return µ.PolyChart()},µ.BarChart.defaultConfig=function(){var t={geometryConfig:{geometryType:"bar"}};return t},µ.AreaChart=function(){return µ.PolyChart()},µ.AreaChart.defaultConfig=function(){var t={geometryConfig:{geometryType:"arc"}};return t},µ.DotPlot=function(){return µ.PolyChart()},µ.DotPlot.defaultConfig=function(){var t={geometryConfig:{geometryType:"dot",dotType:"circle"}};return t},µ.LinePlot=function(){function t(){var t=e.geometryConfig,n=t.container;"string"==typeof n&&(n=d3.select(n)),n.datum(e.data).each(function(e){var n=d3.zip(e.x[0],e.y[0]),a=d3.svg.line.radial().interpolate(t.lineInterpolation).radius(function(e){return t.radialScale(e[1])}).angle(function(e){return t.angularScale(e[0])*Math.PI/180}),i={fill:"none","stroke-width":t.lineStrokeSize,stroke:t.color,"pointer-events":"stroke"},o=d3.select(this).classed("line-plot",!0),l=o.selectAll("path.mark").data([0]);l.enter().append("path").attr({"class":"mark"}),o.select("path.mark").datum(n).attr({d:a,transform:"rotate("+(t.orientation+90)+")","stroke-width":t.lineStrokeSize+"px","stroke-dasharray":r[t.dash],opacity:t.opacity,display:t.visible?"block":"none"}).style(i)})}var e=µ.LinePlot.defaultConfig(),n=d3.dispatch("hover"),r={solid:"none",dash:[5,2],dot:[2,5]};return t.config=function(t){return arguments.length?(µ.util.deepExtend(e,t),this):e},d3.rebind(t,n,"on"),t},µ.LinePlot.defaultConfig=function(){var t={data:{name:"geom1",x:[[1,2,3,4]],y:[[1,2,3,4]]},geometryConfig:{geometry:"LinePlot",color:"#ffa500",dash:"solid",lineStrokeSize:2,lineInterpolation:"linear",direction:"clockwise",orientation:0,container:"body",opacity:1,radialScale:null,angularScale:null,index:0,visible:!0,visibleInLegend:!0}};return t},µ.Legend=function(){function t(){var n=e.legendConfig,r=e.data.map(function(t,e){return[].concat(t).map(function(t,r){var a=µ.util.deepExtend({},n.elements[e]);return a.name=t,a.color=[].concat(n.elements[e].color)[r],a})}),a=d3.merge(r);a=a.filter(function(t,e){return n.elements[e]&&(n.elements[e].visibleInLegend||"undefined"==typeof n.elements[e].visibleInLegend)}),n.reverseOrder&&(a=a.reverse());var i=n.container;("string"==typeof i||i.nodeName)&&(i=d3.select(i));var o=a.map(function(t){return t.color}),l=n.fontSize,s=null==n.isContinuous?"number"==typeof a[0]:n.isContinuous,c=s?n.height:l*a.length,u=i.classed("legend-group",!0),d=u.selectAll("svg").data([0]),g=d.enter().append("svg").attr({width:300,height:c+l,xmlns:"http://www.w3.org/2000/svg","xmlns:xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});g.append("g").classed("legend-axis",!0),g.append("g").classed("legend-marks",!0);var f=d3.range(a.length),p=d3.scale[s?"linear":"ordinal"]().domain(f).range(o),y=d3.scale[s?"linear":"ordinal"]().domain(f)[s?"range":"rangePoints"]([0,c]),m=function(t,e){var n=3*e;return"line"===t?"M"+[[-e/2,-e/12],[e/2,-e/12],[e/2,e/12],[-e/2,e/12]]+"Z":-1!=d3.svg.symbolTypes.indexOf(t)?d3.svg.symbol().type(t).size(n)():d3.svg.symbol().type("square").size(n)()};if(s){var h=d.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(o);h.enter().append("stop"),h.attr({offset:function(t,e){return 100*(e/(o.length-1))+"%"}}).style({"stop-color":function(t){return t}}),d.append("rect").classed("legend-mark",!0).attr({height:n.height,width:n.colorBandWidth,fill:"url(#grad1)"})}else{var v=d.select(".legend-marks").selectAll("path.legend-mark").data(a);v.enter().append("path").classed("legend-mark",!0),v.attr({transform:function(t,e){return"translate("+[l/2,y(e)+l/2]+")"},d:function(t){var e=t.symbol;return m(e,l)},fill:function(t,e){return p(e)}}),v.exit().remove()}var x=d3.svg.axis().scale(y).orient("right"),k=d.select("g.legend-axis").attr({transform:"translate("+[s?n.colorBandWidth:l,l/2]+")"}).call(x);return k.selectAll(".domain").style({fill:"none",stroke:"none"}),k.selectAll("line").style({fill:"none",stroke:s?n.textColor:"none"}),k.selectAll("text").style({fill:n.textColor,"font-size":n.fontSize}).text(function(t,e){return a[e].name}),t}var e=µ.Legend.defaultConfig(),n=d3.dispatch("hover");return t.config=function(t){return arguments.length?(µ.util.deepExtend(e,t),this):e},d3.rebind(t,n,"on"),t},µ.Legend.defaultConfig=function(){var t={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}};return t},µ.tooltipPanel=function(){var t,e,n,r,a={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},i="tooltip-"+µ.tooltipPanel.uid++,o=function(){t=a.container.selectAll("g."+i).data([0]);var l=t.enter().append("g").classed(i,!0).style({"pointer-events":"none"});return r=l.append("circle").attr({cx:5,r:5}).style({fill:"white","fill-opacity":.9}),n=l.append("rect").style({fill:"white","fill-opacity":.9}),e=l.append("text").attr({dy:.3*-a.fontSize,dx:a.padding+5}),o};return o.text=function(i){var l=d3.hsl(a.color).l,s=l>=.5?"#aaa":"white",c=l>=.5?"black":"white",u=i||"";e.style({fill:c,"font-size":a.fontSize+"px"}).text(u);var d=a.padding,g=e.node().getBBox();return n.attr({x:5,y:-(g.height+d),width:g.width+2*d,height:g.height+2*d,rx:0,ry:0}).style({fill:a.color,stroke:s,"stroke-width":"2px"}),r.attr({cy:-(g.height/2)}).style({display:a.hasTick?"block":"none"}),t.style({display:"block"}),o},o.move=function(e){return t?(t.attr({transform:"translate("+[e[0],e[1]]+")"}).style({display:"block"}),o):void 0},o.hide=function(){return t?(t.style({display:"none"}),o):void 0},o.show=function(){return t?(t.style({display:"block"}),o):void 0},o.config=function(t){return µ.util.deepExtend(a,t),o},o},µ.tooltipPanel.uid=1,µ.adapter={},µ.adapter.plotly=function(){var t={};return t.convert=function(t){var e={};if(t.data&&(e.data=t.data.map(function(t){var e=µ.util.deepExtend({},t),n=[[e,["marker","line","color"],["strokeColor"]],[e,["marker","color"],["color"]],[e,["marker","opacity"],["opacity"]],[e,["marker","line","color"],["strokeColor"]],[e,["marker","line","dash"],["dash"]],[e,["marker","line","width"],["strokeSize"]],[e,["marker","type"],["dotType"]],[e,["marker","size"],["dotSize"]],[e,["marker","barRadialOffset"],["barRadialOffset"]],[e,["marker","barWidth"],["barWidth"]],[e,["line","interpolation"],["lineInterpolation"]]];return n.forEach(function(t){µ.util.translator.apply(null,t)}),delete e.marker,t.type&&(e.geometry=t.type.substr("Polar".length)),e}),t.layout&&"stack"===t.layout.barmode)){var n=µ.util.duplicates(e.data.map(function(t){return t.type}));e.data.forEach(function(t,r){var a=n.indexOf(t.type);-1!=a&&(e.data[r].groupId=a)})}if(t.layout){var r=µ.util.deepExtend({},t.layout),a=[[r,["plot_bgcolor"],["backgroundColor"]],[r,["showlegend"],["showLegend"]],[r.angularAxis,["showLine"],["gridLinesVisible"]],[r.angularAxis,["showticklabels"],["labelsVisible"]],[r.angularAxis,["nticks"],["ticksCount"]]];if(a.forEach(function(t){µ.util.translator.apply(null,t)}),r.margin&&"undefined"!=typeof r.margin.t){var i=["t","r","b","l","pad"],o=["top","right","bottom","left","pad"],l={};d3.entries(r.margin).forEach(function(t){l[o[i.indexOf(t.key)]]=t.value}),r.margin=l}e.layout=r,t.container&&(e.layout.container=t.container)}return e},t};
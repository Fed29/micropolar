var micropolar={version:"0.2.1"},µ=micropolar;µ.Axis=function(){function t(i){var l=a.data,s=a.layout;return("string"==typeof i||i.nodeName)&&(i=d3.select(i)),i.datum(l).each(function(t){function a(t){return r(t)%360+s.orientation}var i=t.slice(),l=i.filter(function(t){var e=t.visible;return"undefined"==typeof e||e===!0});o={data:µ.util.cloneJson(i),layout:µ.util.cloneJson(s)};var u=!1,c=l.map(function(t){return u=u||"undefined"!=typeof t.groupId,t});if(u){var d=d3.nest().key(function(t){return"undefined"!=typeof t.groupId?t.groupId:"unstacked"}).entries(c),f=[],g=d.map(function(t){if("unstacked"===t.key)return t.values;var e=t.values[0].y.map(function(){return 0});return t.values.forEach(function(t){t.yStack=[e],f.push(e),e=µ.util.sumArrays(t.y,e)}),t.values});l=d3.merge(g)}l.forEach(function(t){t.x=Array.isArray(t.x[0])?t.x:[t.x],t.y=Array.isArray(t.y[0])?t.y:[t.y]});var p,y=Math.min(s.width-s.margin.left-s.margin.right,s.height-s.margin.top-s.margin.bottom)/2,m=[s.margin.left+y,s.margin.top+y];if(u){var h=d3.max(µ.util.sumArrays(µ.util.arrayLast(l).y[0],µ.util.arrayLast(f)));p=[0,h]}else p=d3.extent(µ.util.flattenArray(l.map(function(t){return t.y})));n=d3.scale.linear().domain(s.radialAxis&&s.radialAxis.domain?s.radialAxis.domain:p).range([0,y]),o.layout.radialAxis.domain=n.domain();var v,x=µ.util.flattenArray(l.map(function(t){return t.x})),k="string"==typeof x[0];k&&(x=µ.util.deduplicate(x),v=x.slice(),x=d3.range(x.length),l=l.map(function(t){var e=t;return t.x=[x],u&&(e.yStack=t.yStack),e}));var b=d3.extent(x),C=s.angularAxis.domain?s.angularAxis.domain.slice():b,A=x[1]-x[0],S=C.slice();s.needsEndSpacing&&(S[1]+=A);var w=s.angularAxis.ticksCount||4;w>8&&(w=w/(w/8)+w%8),s.angularAxis.ticksStep&&(w=(S[1]-S[0])/w);var P=s.angularAxis.ticksStep||(S[1]-S[0])/(w*(s.minorTicks+1));S[2]||(S[2]=P);var E=d3.range.apply(this,S);if(E=E.map(function(t){return parseFloat(t.toPrecision(12))}),r=d3.scale.linear().domain(S.slice(0,2)).range("clockwise"===s.direction?[0,360]:[360,0]),o.layout.angularAxis.domain=r.domain(),r.endPadding=s.needsEndSpacing?A:0,e=d3.select(this).select("svg.chart-root"),"undefined"==typeof e||e.empty()){var z='<svg xmlns="http://www.w3.org/2000/svg" class="chart-root"><g class="outer-group"><g class="chart-group"><circle class="background-circle"></circle><g class="geometry-group"></g><g class="radial axis-group"><circle class="outside-circle"></circle></g><g class="angular axis-group"></g><g class="guides-group"><line></line><circle r="0"></circle></g></g><g class="legend-group"></g><g class="tooltips-group"></g><g class="title-group"><text></text></g></g></svg>',L=(new DOMParser).parseFromString(z,"application/xml"),T=this.appendChild(this.ownerDocument.importNode(L.documentElement,!0));e=d3.select(T)}var M={fill:"none",stroke:s.tickColor},O={"font-size":s.font.size,"font-family":s.font.family,fill:s.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(t){return" "+t+" 0 "+s.font.outlineColor}).join(",")};e.attr({width:s.width,height:s.height}).style({opacity:s.opacity});var I=e.select(".chart-group").attr("transform","translate("+m+")").style({cursor:"crosshair"});e.select(".guides-group").style({"pointer-events":"none"}),e.select(".angular.axis-group").style({"pointer-events":"none"}),e.select(".radial.axis-group").style({"pointer-events":"none"});var B=e.select(".radial.axis-group");if(s.radialAxis.gridLinesVisible){var R=B.selectAll("circle.grid-circle").data(n.ticks(5));R.enter().append("circle").attr({"class":"grid-circle"}).style(M),R.attr("r",n),R.exit().remove()}B.select("circle.outside-circle").attr({r:y}).style(M);var D=e.select("circle.background-circle").attr({r:y}).style({fill:s.backgroundColor,stroke:s.stroke});if(s.radialAxis.visible){var V=d3.svg.axis().scale(n).ticks(5).tickSize(5);B.call(V).attr({transform:"rotate("+s.radialAxis.orientation+")"}),B.selectAll(".domain").style(M),B.selectAll("g>text").text(function(){return this.textContent+s.radialAxis.ticksSuffix}).style(O).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(){return"horizontal"===s.radialAxis.tickOrientation?"rotate("+-s.radialAxis.orientation+") translate("+[0,O["font-size"]]+")":"translate("+[0,O["font-size"]]+")"}}),B.selectAll("g>line").style({stroke:"black"})}var q=e.select(".angular.axis-group").selectAll("g.angular-tick").data(E),W=q.enter().append("g").classed("angular-tick",!0);q.attr({transform:function(t,e){return"rotate("+a(t,e)+")"}}).style({display:s.angularAxis.visible?"block":"none"}),q.exit().remove(),W.append("line").classed("grid-line",!0).classed("major",function(t,e){return 0==e%(s.minorTicks+1)}).classed("minor",function(t,e){return!(0==e%(s.minorTicks+1))}).style(M),W.selectAll(".minor").style({stroke:s.minorTickColor}),q.select("line.grid-line").attr({x1:s.tickLength?y-s.tickLength:0,x2:y}).style({display:s.angularAxis.gridLinesVisible?"block":"none"}),W.append("text").classed("axis-text",!0).style(O);var j=q.select("text.axis-text").attr({x:y+s.labelOffset,dy:".35em",transform:function(t,e){var n=a(t,e),r=y+s.labelOffset,i=s.angularAxis.tickOrientation;return"horizontal"==i?"rotate("+-n+" "+r+" 0)":"radial"==i?270>n&&n>90?"rotate(180 "+r+" 0)":null:"rotate("+(180>=n&&n>0?-90:90)+" "+r+" 0)"}}).style({"text-anchor":"middle",display:s.angularAxis.labelsVisible?"block":"none"}).text(function(t,e){return 0!=e%(s.minorTicks+1)?"":v?v[e/(s.minorTicks+1)]+s.angularAxis.ticksSuffix:t+s.angularAxis.ticksSuffix}).style(O);s.angularAxis.rewriteTicks&&j.text(function(t,e){return 0!=e%(s.minorTicks+1)?"":s.angularAxis.rewriteTicks(this.textContent,e)});var J=e.select("g.geometry-group").selectAll("g").size()>0;if(l[0]||J){var N=0,F=[];i.forEach(function(t,e){t.color||(t.color=s.defaultColorRange[N],o.data[e].color=t.color,o.data[e].strokeColor=t.strokeColor,o.data[e].strokeDash=t.strokeDash,o.data[e].strokeSize=t.strokeSize,N=(N+1)%s.defaultColorRange.length)}),l.forEach(function(t,a){var i="geometry"+a,o=e.select("g.geometry-group").selectAll("g."+i).data([0]);o.enter().append("g").classed(i,!0);var l={};l.radialScale=n,l.angularScale=r,l.container=o,l.geometry=t.geometry,l.orientation||(l.orientation=s.orientation),l.direction=s.direction,l.index=a,F.push({data:t,geometryConfig:l})});var _=d3.nest().key(function(t){return"undefined"!=typeof t.data.groupId||"unstacked"}).entries(F),K=[];_.forEach(function(t){"unstacked"===t.key?K=K.concat(t.values.map(function(t){return[t]})):K.push(t.values)}),K.forEach(function(t){var e;e=Array.isArray(t)?t[0].geometryConfig.geometry:t.geometryConfig.geometry;var n=t.map(function(t){return µ.util.deepExtend(µ[e].defaultConfig(),t)});µ[e]().config(n)()})}if(s.showLegend){var Z=d3.max(I.selectAll(".angular-tick text")[0].map(function(t){return t.getCTM().e+t.getBBox().width})),G=e.select(".legend-group").attr({transform:"translate("+[y+Z,s.margin.top]+")"}).style({display:"block"}),H=l.map(function(t){return t.symbol="line",t.visibleInLegend="undefined"==typeof t.visibleInLegend||t.visibleInLegend,t.color=t.color||"black",t}),Q=µ.util.deepExtend({},µ.Legend.defaultConfig().legendConfig),U=µ.util.deepExtend(Q,{container:G,elements:H}),X={data:l.map(function(t,e){return t.name||"Element"+e}),legendConfig:U};µ.Legend().config(X)()}else e.select(".legend-group").style({display:"none"});if(s.title){var Y=e.select("g.title-group text").attr({x:100,y:100}).style(O).text(s.title),$=Y.node().getBBox();Y.attr({x:s.margin.left+y-$.width/2,y:$.height})}e.select(".geometry-group g").style({"pointer-events":"visible"});var te,ee,ne=e.select(".guides-group"),re=e.select(".tooltips-group"),ae=µ.tooltipPanel().config({container:re,fontSize:8})(),ie=µ.tooltipPanel().config({container:re,fontSize:8})(),oe=µ.tooltipPanel().config({container:re,hasTick:!0})();if(!k){var le=ne.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});I.on("mousemove.angular-guide",function(){var t=µ.util.getMousePos(D).angle;le.attr({x2:-y,transform:"rotate("+t+")"}).style({opacity:.5});var e=(t+360+s.orientation)%360;te=r.invert(e);var n=µ.util.convertToCartesian(y+12,t+180);ae.text(µ.util.round(te)).move([n[0]+m[0],n[1]+m[1]])}).on("mouseout.angular-guide",function(){ne.select("line").style({opacity:0})})}var se=ne.select("circle").style({stroke:"grey",fill:"none"});I.on("mousemove.radial-guide",function(){var t=µ.util.getMousePos(D).radius;se.attr({r:t}).style({opacity:.5}),ee=n.invert(µ.util.getMousePos(D).radius);var e=µ.util.convertToCartesian(t,s.radialAxis.orientation);ie.text(µ.util.round(ee)).move([e[0]+m[0],e[1]+m[1]])}).on("mouseout.radial-guide",function(){se.style({opacity:0}),oe.hide(),ae.hide(),ie.hide()}),e.selectAll(".geometry-group .mark").on("mouseenter.tooltip",function(t){var n=d3.select(this),r=n.style("fill"),a="black",i=n.style("opacity")||1;if(n.attr({"data-opacity":i}),"none"!=r){n.attr({"data-fill":r}),a=d3.hsl(r).darker().toString(),n.style({fill:a,opacity:1});var o=this.getBoundingClientRect(),l=e.node().getBoundingClientRect(),s=[o.left-l.left+o.width/2-ue[0],o.top-l.top+o.height/2-ue[1]],u="θ: "+µ.util.round(t[0])+", r: "+µ.util.round(t[1]);oe.config({color:a}).text(u),oe.move(s)}else r=n.style("stroke"),n.attr({"data-stroke":r}),a=d3.hsl(r).darker().toString(),n.style({stroke:a,opacity:1})}).on("mousemove.tooltip",function(){d3.select(this).attr("data-fill")&&oe.show()}).on("mouseout.tooltip",function(){oe.hide();var t=d3.select(this),e=t.attr("data-fill");e?t.style({fill:e,opacity:t.attr("data-opacity")}):t.style({stroke:t.attr("data-stroke"),opacity:t.attr("data-opacity")})});var ue=[s.width/2-y-s.margin.left,s.height/2-y-s.margin.top];e.select(".outer-group")}),t}var e,n,r,a={data:[],layout:{}},i={},o={},l=d3.dispatch("hover");return t.config=function(t){if(!arguments.length)return a;var e=µ.util.cloneJson(t);return e.data.forEach(function(t,e){a.data[e]||(a.data[e]={}),µ.util.deepExtend(a.data[e],µ.Axis.defaultConfig().data[0]),µ.util.deepExtend(a.data[e],t)}),µ.util.deepExtend(a.layout,µ.Axis.defaultConfig().layout),µ.util.deepExtend(a.layout,e.layout),this},t.getLiveConfig=function(){return o},t.getinputConfig=function(){return i},t.radialScale=function(){return n},t.angularScale=function(){return r},t.svg=function(){return e},d3.rebind(t,l,"on"),t},µ.Axis.defaultConfig=function(){var t={data:[{x:[1,2,3,4],y:[10,11,12,13],name:"Line1",geometry:"LineChart",color:"limegreen",strokeDash:"solid",strokeColor:"silver",strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:d3.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:31,color:"red",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:null,ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:1,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:!0,showLegend:!0,opacity:1}};return t},µ.util={},µ.util._override=function(t,e){for(var n in t)n in e&&(e[n]=t[n])},µ.util._extend=function(t,e){for(var n in t)e[n]=t[n]},µ.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},µ.util.dataFromEquation2=function(t,e){var n=e||6,r=d3.range(0,360+n,n).map(function(e){var n=e*Math.PI/180,r=t(n);return[e,r]});return r},µ.util.dataFromEquation=function(t,e,n){var r=e||6,a=[],i=[];d3.range(0,360+r,r).forEach(function(e){var n=e*Math.PI/180,r=t(n);a.push(e),i.push(r)});var o={x:a,y:i};return n&&(o.name=n),o},µ.util.ensureArray=function(t,e){if("undefined"==typeof t)return null;var n=[].concat(t);return d3.range(e).map(function(t,e){return n[e]||n[0]})},µ.util.fillArrays=function(t,e,n){return e.forEach(function(e){t[e]=µ.util.ensureArray(t[e],n)}),t},µ.util.cloneJson=function(t){return JSON.parse(JSON.stringify(t))},µ.util.deepExtend=function(t,e){for(var n in e)e[n]&&e[n].constructor&&e[n].constructor===Object?(t[n]=t[n]||{},arguments.callee(t[n],e[n])):t[n]=e[n];return t},µ.util.validateKeys=function(t,e){"string"==typeof e&&(e=e.split("."));var n=e.shift();return t[n]&&(!e.length||objHasKeys(t[n],e))},µ.util.sumArrays=function(t,e){return d3.zip(t,e).map(function(t){return d3.sum(t)})},µ.util.arrayLast=function(t){return t[t.length-1]},µ.util.arrayEqual=function(t,e){for(var n=Math.max(t.length,e.length,1);n-->=0&&t[n]===e[n];);return-2===n},µ.util.flattenArray=function(t){for(var e=[];!µ.util.arrayEqual(e,t);)e=t,t=[].concat.apply([],t);return t},µ.util.deduplicate=function(t){return t.filter(function(t,e,n){return n.indexOf(t)==e})},µ.util.convertToCartesian=function(t,e){var n=e*Math.PI/180,r=t*Math.cos(n),a=t*Math.sin(n);return[r,a]},µ.util.round=function(t,e){var n=e||2,r=Math.pow(10,n);return Math.round(t*r)/r},µ.util.getMousePos=function(t){var e=d3.mouse(t.node()),n=e[0],r=e[1],a={};return a.x=n,a.y=r,a.pos=e,a.angle=180*(Math.atan2(r,n)+Math.PI)/Math.PI,a.radius=Math.sqrt(n*n+r*r),a},µ.util.duplicatesCount=function(t){for(var e,n={},r={},a=0,i=t.length;i>a;a++)e=t[a],e in n?(n[e]++,r[e]=n[e]):n[e]=1;return r},µ.util.duplicates=function(t){return Object.keys(µ.util.duplicatesCount(t))},µ.util.translator=function(t,e,n,r){if(r){var a=n.slice();n=e,e=a}var i=e.reduce(function(t,e){return"undefined"!=typeof t?t[e]:void 0},t);"undefined"!=typeof i&&(e.reduce(function(t,n,r){return"undefined"!=typeof t?(r===e.length-1&&delete t[n],t[n]):void 0},t),n.reduce(function(t,e,r){return"undefined"==typeof t[e]&&(t[e]={}),r===n.length-1&&(t[e]=i),t[e]},t))},µ.PolyChart=function(){function t(){var t=n[0].geometryConfig,e=t.container;"string"==typeof e&&(e=d3.select(e)),e.datum(n).each(function(e){function n(e){var n=t.radialScale(e[1]),r=(t.angularScale(e[0])+t.orientation)*Math.PI/180;return{r:n,θ:r}}function r(t){var e=t.r*Math.cos(t.θ),n=t.r*Math.sin(t.θ);return{x:e,y:n}}var i=!!e[0].data.yStack,o=e.map(function(t){return i?d3.zip(t.data.x[0],t.data.y[0],t.data.yStack[0]):d3.zip(t.data.x[0],t.data.y[0])}),l=t.angularScale,s=t.angularScale.copy().range(t.angularScale.range().slice().reverse()),u="clockwise"===t.direction?l:s,c=t.radialScale.domain()[0],d={};d.bar=function(n,r,a){var i=e[a].data,o=t.radialScale(n[1]),s=t.radialScale(c+(n[2]||0));i.barRadialOffset&&(s=i.barRadialOffset,o-=s);var u=i.barWidth;d3.select(this).attr({d:"M"+[[o+s,-u/2],[o+s,u/2],[s,u/2],[s,-u/2]].join("L")+"Z",transform:function(e){return"rotate("+(t.orientation+l(e[0]))+")"}})},d.dot=function(t,a,i){var o=d3.svg.symbol().size(e[i].data.dotSize).type(e[i].data.dotType)(t,a);d3.select(this).attr({d:o,transform:function(t){var e=r(n(t));return"translate("+[e.x,e.y]+")"}})};var f=d3.svg.line.radial().radius(function(e){return t.radialScale(e[1])}).angle(function(e){return t.angularScale(e[0])*Math.PI/180});d.line=function(e,n,r){if(!(n>0)){var a=e[2]?o[r].map(function(t){return[t[0],t[1]+t[2]]}):o[r];d3.select(this).attr({d:f(a),transform:function(e){return"rotate("+(t.orientation+l(e[0])+90)+")"}})}};var g=u(o[0][1][0])*Math.PI/180/2,p=d3.svg.arc().startAngle(function(){return-g+Math.PI/2}).endAngle(function(){return g+Math.PI/2}).innerRadius(function(e){return t.radialScale(c+(e[2]||0))}).outerRadius(function(e){return t.radialScale(c+(e[2]||0))+t.radialScale(e[1])});d.arc=function(){d3.select(this).attr({d:p,transform:function(e){return"rotate("+(t.orientation+l(e[0]))+")"}})};var y={fill:function(t,n,r){return e[r].data.color},stroke:function(t,n,r){return e[r].data.strokeColor},"stroke-width":function(t,n,r){return e[r].data.strokeSize+"px"},"stroke-dasharray":function(t,n,r){return a[e[r].data.strokeDash]},opacity:function(t,n,r){return e[r].data.opacity},display:function(t,n,r){return"undefined"==typeof e[r].data.visible||e[r].data.visible?"block":"none"}},m=d3.select(this).selectAll("g.layer").data(o);m.enter().append("g").classed("layer",!0);var h=m.selectAll("path.mark").data(function(t){return t});h.enter().append("path").attr({"class":"mark"}),h.each(d[t.geometryType]).style(y)})}var e,n=[µ.PolyChart.defaultConfig()],r=d3.dispatch("hover"),a={solid:"none",dash:[5,2],dot:[2,5]};return t.config=function(t){return arguments.length?(t.forEach(function(t,e){n[e]||(n[e]={}),µ.util.deepExtend(n[e],µ.PolyChart.defaultConfig()),µ.util.deepExtend(n[e],t)}),this):n},t.getColorScale=function(){return e},d3.rebind(t,r,"on"),t},µ.PolyChart.defaultConfig=function(){var t={data:{name:"geom1",x:[[1,2,3,4]],y:[[1,2,3,4]],dotType:"circle",dotSize:64,barRadialOffset:null,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:d3.scale.category20()}};return t},µ.BarChart=function(){return µ.PolyChart()},µ.BarChart.defaultConfig=function(){var t={geometryConfig:{geometryType:"bar"}};return t},µ.AreaChart=function(){return µ.PolyChart()},µ.AreaChart.defaultConfig=function(){var t={geometryConfig:{geometryType:"arc"}};return t},µ.DotPlot=function(){return µ.PolyChart()},µ.DotPlot.defaultConfig=function(){var t={geometryConfig:{geometryType:"dot",dotType:"circle"}};return t},µ.LinePlot=function(){return µ.PolyChart()},µ.LinePlot.defaultConfig=function(){var t={geometryConfig:{geometryType:"line"}};return t},µ.Legend=function(){function t(){var n=e.legendConfig,r=e.data.map(function(t,e){return[].concat(t).map(function(t,r){var a=µ.util.deepExtend({},n.elements[e]);return a.name=t,a.color=[].concat(n.elements[e].color)[r],a})}),a=d3.merge(r);a=a.filter(function(t,e){return n.elements[e]&&(n.elements[e].visibleInLegend||"undefined"==typeof n.elements[e].visibleInLegend)}),n.reverseOrder&&(a=a.reverse());var i=n.container;("string"==typeof i||i.nodeName)&&(i=d3.select(i));var o=a.map(function(t){return t.color}),l=n.fontSize,s=null==n.isContinuous?"number"==typeof a[0]:n.isContinuous,u=s?n.height:l*a.length,c=i.classed("legend-group",!0),d=c.selectAll("svg").data([0]),f=d.enter().append("svg").attr({width:300,height:u+l,xmlns:"http://www.w3.org/2000/svg","xmlns:xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});f.append("g").classed("legend-axis",!0),f.append("g").classed("legend-marks",!0);var g=d3.range(a.length),p=d3.scale[s?"linear":"ordinal"]().domain(g).range(o),y=d3.scale[s?"linear":"ordinal"]().domain(g)[s?"range":"rangePoints"]([0,u]),m=function(t,e){var n=3*e;return"line"===t?"M"+[[-e/2,-e/12],[e/2,-e/12],[e/2,e/12],[-e/2,e/12]]+"Z":-1!=d3.svg.symbolTypes.indexOf(t)?d3.svg.symbol().type(t).size(n)():d3.svg.symbol().type("square").size(n)()};if(s){var h=d.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(o);h.enter().append("stop"),h.attr({offset:function(t,e){return 100*(e/(o.length-1))+"%"}}).style({"stop-color":function(t){return t}}),d.append("rect").classed("legend-mark",!0).attr({height:n.height,width:n.colorBandWidth,fill:"url(#grad1)"})}else{var v=d.select(".legend-marks").selectAll("path.legend-mark").data(a);v.enter().append("path").classed("legend-mark",!0),v.attr({transform:function(t,e){return"translate("+[l/2,y(e)+l/2]+")"},d:function(t){var e=t.symbol;return m(e,l)},fill:function(t,e){return p(e)}}),v.exit().remove()}var x=d3.svg.axis().scale(y).orient("right"),k=d.select("g.legend-axis").attr({transform:"translate("+[s?n.colorBandWidth:l,l/2]+")"}).call(x);return k.selectAll(".domain").style({fill:"none",stroke:"none"}),k.selectAll("line").style({fill:"none",stroke:s?n.textColor:"none"}),k.selectAll("text").style({fill:n.textColor,"font-size":n.fontSize}).text(function(t,e){return a[e].name}),t}var e=µ.Legend.defaultConfig(),n=d3.dispatch("hover");return t.config=function(t){return arguments.length?(µ.util.deepExtend(e,t),this):e},d3.rebind(t,n,"on"),t},µ.Legend.defaultConfig=function(){var t={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}};return t},µ.tooltipPanel=function(){var t,e,n,r,a={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},i="tooltip-"+µ.tooltipPanel.uid++,o=function(){t=a.container.selectAll("g."+i).data([0]);var l=t.enter().append("g").classed(i,!0).style({"pointer-events":"none"});return r=l.append("circle").attr({cx:5,r:5}).style({fill:"white","fill-opacity":.9}),n=l.append("rect").style({fill:"white","fill-opacity":.9}),e=l.append("text").attr({dy:.3*-a.fontSize,dx:a.padding+5}),o};return o.text=function(i){var l=d3.hsl(a.color).l,s=l>=.5?"#aaa":"white",u=l>=.5?"black":"white",c=i||"";e.style({fill:u,"font-size":a.fontSize+"px"}).text(c);var d=a.padding,f=e.node().getBBox();return n.attr({x:5,y:-(f.height+d),width:f.width+2*d,height:f.height+2*d,rx:0,ry:0}).style({fill:a.color,stroke:s,"stroke-width":"2px"}),r.attr({cy:-(f.height/2)}).style({display:a.hasTick?"block":"none"}),t.style({display:"block"}),o},o.move=function(e){return t?(t.attr({transform:"translate("+[e[0],e[1]]+")"}).style({display:"block"}),o):void 0},o.hide=function(){return t?(t.style({display:"none"}),o):void 0},o.show=function(){return t?(t.style({display:"block"}),o):void 0},o.config=function(t){return µ.util.deepExtend(a,t),o},o},µ.tooltipPanel.uid=1,µ.adapter={},µ.adapter.plotly=function(){var t={};return t.convert=function(t,e){var n={};if(t.data&&(n.data=t.data.map(function(t){var n=µ.util.deepExtend({},t),r=[[n,["marker","color"],["color"]],[n,["marker","opacity"],["opacity"]],[n,["marker","line","color"],["strokeColor"]],[n,["marker","line","dash"],["strokeDash"]],[n,["marker","line","width"],["strokeSize"]],[n,["marker","type"],["dotType"]],[n,["marker","size"],["dotSize"]],[n,["marker","barRadialOffset"],["barRadialOffset"]],[n,["marker","barWidth"],["barWidth"]],[n,["line","interpolation"],["lineInterpolation"]],[n,["type"],["geometry"]]];return r.forEach(function(t){µ.util.translator.apply(null,t.concat(e))}),e||delete n.marker,n.geometry&&-1!=n.geometry.indexOf("Polar")&&!e&&(n.geometry=n.geometry.substr("Polar".length)),n.type&&-1==n.type.indexOf("Polar")&&e&&(n.type="Polar"+n.type),n}),t.layout&&"stack"===t.layout.barmode)){var r=µ.util.duplicates(n.data.map(function(t){return t.geometry}));n.data.forEach(function(t,e){var a=r.indexOf(t.geometry);-1!=a&&(n.data[e].groupId=a)})}if(t.layout){var a=µ.util.deepExtend({},t.layout),i=[[a,["plot_bgcolor"],["backgroundColor"]],[a,["showlegend"],["showLegend"]],[a.angularAxis,["showLine"],["gridLinesVisible"]],[a.angularAxis,["showticklabels"],["labelsVisible"]],[a.angularAxis,["nticks"],["ticksCount"]]];if(i.forEach(function(t){µ.util.translator.apply(null,t.concat(e))}),a.margin&&"undefined"!=typeof a.margin.t){var o=["t","r","b","l","pad"],l=["top","right","bottom","left","pad"],s={};d3.entries(a.margin).forEach(function(t){s[l[o.indexOf(t.key)]]=t.value}),a.margin=s}n.layout=a}return n},t};
var micropolar={version:"0.2"},µ=micropolar;µ.Axis=function(){function e(){var i=a.data,o=a.axisConfig,l=a.geometryConfig,u=a.legendConfig,s=o.container;return("string"==typeof s||s.nodeName)&&(s=d3.select(s)),s.datum(i).each(function(e){function i(e){return r(e)%360+o.originTheta}var s=e.slice();s=s.filter(function(e,t){var n=l[t].visible;return"undefined"==typeof n||n===!0}),l=l.filter(function(e){var t=e.visible;return"undefined"==typeof t||t===!0});var c=!1,d=s.map(function(e,t){return e.groupId=l[t].groupId,c=c||"undefined"!=typeof e.groupId,e});if(c){var f=d3.nest().key(function(e){return"undefined"!=typeof e.groupId?e.groupId:"unstacked"}).entries(d),g=[],p=f.map(function(e){if("unstacked"===e.key)return e.values;var t=e.values[0].y.map(function(){return 0});return e.values.forEach(function(e){e.yStack=[t],g.push(t),t=µ.util.sumArrays(e.y,t)}),e.values});s=d3.merge(p)}var y,s=s.map(function(e){var t={};return t.name=e.name,t.x=Array.isArray(e.x[0])?e.x:[e.x],t.y=Array.isArray(e.y[0])?e.y:[e.y],t.yStack=e.yStack,t}),m=Math.min(o.width-o.margin.left-o.margin.right,o.height-o.margin.top-o.margin.bottom)/2,h=[o.margin.left+m,o.margin.top+m];if(c){var v=d3.max(µ.util.sumArrays(µ.util.arrayLast(s).y[0],µ.util.arrayLast(g)));y=[0,v]}else y=d3.extent(µ.util.flattenArray(s.map(function(e){return e.y})));n=d3.scale.linear().domain(o.radialDomain||y).range([0,m]);var k,x=µ.util.flattenArray(s.map(function(e){return e.x})),C="string"==typeof x[0];C&&(x=µ.util.deduplicate(x),k=x.slice(),x=d3.range(x.length),s=s.map(function(e){var t={name:e.name,x:[x],y:e.y,yStack:e.yStack};return c&&(t.yStack=e.yStack),t}));var b=d3.extent(x),S=o.angularDomain?o.angularDomain.slice():b,T=x[1]-x[0];o.needsEndSpacing&&(S[1]+=T);var w=o.angularTicksCount||4;w>8&&(w=w/(w/8)+w%8),o.angularTicksStep&&(w=(S[1]-S[0])/w);var A=o.angularTicksStep||(S[1]-S[0])/(w*(o.minorTicks+1));S[2]||(S[2]=A);var z=d3.range.apply(this,S);if(z=z.map(function(e){return parseFloat(e.toPrecision(12))}),r=d3.scale.linear().domain(S.slice(0,2)).range(o.flip?[0,360]:[360,0]),r.endPadding=o.needsEndSpacing?T:0,t=d3.select(this).select("svg.chart-root"),"undefined"==typeof t||t.empty()){var P='<svg xmlns="http://www.w3.org/2000/svg" class="chart-root"><g class="outer-group"><g class="chart-group"><circle class="background-circle"></circle><g class="geometry-group"></g><g class="radial axis-group"><circle class="outside-circle"></circle></g><g class="angular axis-group"></g><g class="guides-group"><line></line><circle r="0"></circle></g></g><g class="legend-group"></g><g class="tooltips-group"></g><g class="title-group"><text></text></g></g></svg>',E=(new DOMParser).parseFromString(P,"application/xml"),L=this.appendChild(this.ownerDocument.importNode(E.documentElement,!0));t=d3.select(L)}var M={fill:"none",stroke:o.tickColor},I={"font-size":o.fontSize,"font-family":o.fontFamily,fill:o.fontColor,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(e){return" "+e+" 0 "+o.fontOutlineColor}).join(",")};t.attr({width:o.width,height:o.height});var O=t.select(".chart-group").attr("transform","translate("+h+")").style({cursor:"crosshair"});t.select(".guides-group").style({"pointer-events":"none"}),t.select(".angular.axis-group").style({"pointer-events":"none"}),t.select(".radial.axis-group").style({"pointer-events":"none"});var R=t.select(".radial.axis-group");if(o.showRadialCircle){var B=R.selectAll("circle.grid-circle").data(n.ticks(5));B.enter().append("circle").attr({"class":"grid-circle"}).style(M),B.attr("r",n),B.exit().remove()}R.select("circle.outside-circle").attr({r:m}).style(M);var D=t.select("circle.background-circle").attr({r:m}).style({fill:o.backgroundColor,stroke:o.stroke});if(o.showRadialAxis){var F=d3.svg.axis().scale(n).ticks(5).tickSize(5);R.call(F).attr({transform:"rotate("+o.radialAxisTheta+")"}),R.selectAll(".domain").style(M),R.selectAll("g>text").text(function(){return this.textContent+o.radialTicksSuffix}).style(I).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(){return"horizontal"===o.radialTickOrientation?"rotate("+-o.radialAxisTheta+") translate("+[0,I["font-size"]]+")":"translate("+[0,I["font-size"]]+")"}}),R.selectAll("g>line").style({stroke:"black"})}var W=t.select(".angular.axis-group").selectAll("g.angular-tick").data(z),q=W.enter().append("g").classed("angular-tick",!0);W.attr({transform:function(e,t){return"rotate("+i(e,t)+")"}}),W.exit().remove(),q.append("line").classed("grid-line",!0).classed("major",function(e,t){return 0==t%(o.minorTicks+1)}).classed("minor",function(e,t){return!(0==t%(o.minorTicks+1))}).style(M),q.selectAll(".minor").style({stroke:o.minorTickColor}),W.select("line.grid-line").attr({x1:o.tickLength?m-o.tickLength:0,x2:m}),q.append("text").classed("axis-text",!0).style(I);var j=W.select("text.axis-text").attr({x:m+o.labelOffset,dy:".35em",transform:function(e,t){var n=i(e,t),r=m+o.labelOffset,a=o.angularTickOrientation;return"horizontal"==a?"rotate("+-n+" "+r+" 0)":"radial"==a?270>n&&n>90?"rotate(180 "+r+" 0)":null:"rotate("+(180>=n&&n>0?-90:90)+" "+r+" 0)"}}).style({"text-anchor":"middle"}).text(function(e,t){return 0!=t%(o.minorTicks+1)?"":k?k[t/(o.minorTicks+1)]+o.angularTicksSuffix:e+o.angularTicksSuffix}).style(I);o.angularRewriteTicks&&j.text(function(e,t){return 0!=t%(o.minorTicks+1)?"":o.angularRewriteTicks(this.textContent,t)});var _=t.select("g.geometry-group").selectAll("g").size()>0;if(l[0]||_){var N=0,K=[];a.geometryConfig.forEach(function(e){e.color||(e.color=o.defaultColorRange[N],N=(N+1)%o.defaultColorRange.length)}),l.forEach(function(e,a){var i="geometry"+a,u=t.select("g.geometry-group").selectAll("g."+i).data([0]);u.enter().append("g").classed(i,!0);var c=µ[l[a].geometry](),d=µ.util.deepExtend({},e);d.radialScale=n,d.angularScale=r,d.container=u,d.originTheta||(d.originTheta=o.originTheta),d.index=a,d.flip=o.flip;var f=µ.util.deepExtend(µ[e.geometry].defaultConfig().geometryConfig,d);K.push({data:s[a],geometryConfig:f,geometry:c})});var Z=d3.nest().key(function(e){return e.geometryConfig.groupId||"unstacked"}).entries(K),G=[];Z.forEach(function(e){"unstacked"===e.key?G=G.concat(e.values):G.push(e.values)}),G.forEach(function(e){var t;t=Array.isArray(e)?e[0].geometry:e.geometry,t.config(e)()})}if(u.showLegend){var H=d3.max(O.selectAll(".angular-tick text")[0].map(function(e){return e.getCTM().e+e.getBBox().width})),J=t.select(".legend-group").attr({transform:"translate("+[m+H,o.margin.top]+")"}).style({display:"block"}),Q=l.map(function(e){return e.symbol="line",e.visibleInLegend="undefined"==typeof e.visibleInLegend||e.visibleInLegend,e.color=e.color||"black",e}),U=µ.util.deepExtend(µ.Legend.defaultConfig().legendConfig,u),V=µ.util.deepExtend(U,{container:J,elements:Q}),X={data:s.map(function(e,t){return e.name||"Element"+t}),legendConfig:V};µ.Legend().config(X)()}else t.select(".legend-group").style({display:"none"});if(o.title){var Y=t.select("g.title-group text").attr({x:100,y:100}).style({"font-size":18,"font-family":o.fontFamily,fill:o.fontColor}).text(o.title),$=Y.node().getBBox();Y.attr({x:o.margin.left+m-$.width/2,y:$.height})}t.select(".geometry-group g").style({"pointer-events":"visible"});var et,tt,nt=t.select(".guides-group"),rt=t.select(".tooltips-group"),at=µ.tooltipPanel().config({container:rt,fontSize:8})(),it=µ.tooltipPanel().config({container:rt,fontSize:8})(),ot=µ.tooltipPanel().config({container:rt,hasTick:!0})();if(!C){var lt=nt.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});O.on("mousemove.angular-guide",function(){var e=µ.util.getMousePos(D).angle;lt.attr({x2:-m,transform:"rotate("+e+")"}).style({opacity:.5});var t=(e+360+o.originTheta)%360;et=r.invert(t);var n=µ.util.convertToCartesian(m+12,e+180);at.text(µ.util.round(et)).move([n[0]+h[0],n[1]+h[1]])}).on("mouseout.angular-guide",function(){nt.select("line").style({opacity:0})})}var ut=nt.select("circle").style({stroke:"grey",fill:"none"});O.on("mousemove.radial-guide",function(){var e=µ.util.getMousePos(D).radius;ut.attr({r:e}).style({opacity:.5}),tt=n.invert(µ.util.getMousePos(D).radius);var t=µ.util.convertToCartesian(e,o.radialAxisTheta);it.text(µ.util.round(tt)).move([t[0]+h[0],t[1]+h[1]])}).on("mouseout.radial-guide",function(){ut.style({opacity:0}),ot.hide(),at.hide(),it.hide()}),t.selectAll(".geometry-group .mark").on("mouseenter.tooltip",function(e){var n=d3.select(this),r=n.style("fill"),a="black",i=n.style("opacity")||1;if(n.attr({"data-opacity":i}),"none"!=r){n.attr({"data-fill":r}),a=d3.hsl(r).darker().toString(),n.style({fill:a,opacity:1});var o=this.getBoundingClientRect(),l=t.node().getBoundingClientRect(),u=[o.left-l.left+o.width/2-st[0],o.top-l.top+o.height/2-st[1]],s="θ: "+µ.util.round(e[0])+", r: "+µ.util.round(e[1]);ot.config({color:a}).text(s),ot.move(u)}else r=n.style("stroke"),n.attr({"data-stroke":r}),a=d3.hsl(r).darker().toString(),n.style({stroke:a,opacity:1})}).on("mousemove.tooltip",function(){d3.select(this).attr("data-fill")&&ot.show()}).on("mouseout.tooltip",function(){ot.hide();var e=d3.select(this),t=e.attr("data-fill");t?e.style({fill:t,opacity:e.attr("data-opacity")}):e.style({stroke:e.attr("data-stroke"),opacity:e.attr("data-opacity")})});var st=[o.width/2-m-o.margin.left,o.height/2-m-o.margin.top];t.select(".outer-group").attr("transform","translate("+st+")")}),e}var t,n,r,a=µ.Axis.defaultConfig(),i=d3.dispatch("hover");return e.config=function(e){return arguments.length?(µ.util.deepExtend(a,e),this):a},e.radialScale=function(){return n},e.angularScale=function(){return r},e.svg=function(){return t},d3.rebind(e,i,"on"),e},µ.Axis.defaultConfig=function(){var e={data:[{x:[1,2,3,4],y:[10,11,12,13],name:"Line1"},{x:[21,22,23,24],y:[30,31,32,33],name:"Line2"}],geometryConfig:[],legendConfig:{showLegend:!0},axisConfig:{defaultColorRange:d3.scale.category10().range(),radialDomain:null,angularDomain:null,angularTicksStep:null,angularTicksCount:null,title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},fontSize:11,fontColor:"black",fontFamily:"Tahoma, sans-serif",fontOutlineColor:"white",flip:!1,originTheta:0,labelOffset:10,radialAxisTheta:-45,radialTicksSuffix:"",angularTicksSuffix:"",angularTicks:null,showRadialAxis:!0,showRadialCircle:!0,minorTicks:1,tickLength:null,tickColor:"silver",minorTickColor:"#eee",angularRewriteTicks:null,radialRewriteTicks:null,angularTickOrientation:"horizontal",radialTickOrientation:"horizontal",container:"body",backgroundColor:"none",needsEndSpacing:!0}};return e},µ.util={},µ.util._override=function(e,t){for(var n in e)n in t&&(t[n]=e[n])},µ.util._extend=function(e,t){for(var n in e)t[n]=e[n]},µ.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},µ.util.dataFromEquation2=function(e,t){var n=t||6,r=d3.range(0,360+n,n).map(function(t){var n=t*Math.PI/180,r=e(n);return[t,r]});return r},µ.util.dataFromEquation=function(e,t,n){var r=t||6,a=[],i=[];d3.range(0,360+r,r).forEach(function(t){var n=t*Math.PI/180,r=e(n);a.push(t),i.push(r)});var o={x:a,y:i};return n&&(o.name=n),o},µ.util.ensureArray=function(e,t){if("undefined"==typeof e)return null;var n=[].concat(e);return d3.range(t).map(function(e,t){return n[t]||n[0]})},µ.util.fillArrays=function(e,t,n){return t.forEach(function(t){e[t]=µ.util.ensureArray(e[t],n)}),e},µ.util.deepExtend=function(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},arguments.callee(e[n],t[n])):e[n]=t[n];return e},µ.util.validateKeys=function(e,t){"string"==typeof t&&(t=t.split("."));var n=t.shift();return e[n]&&(!t.length||objHasKeys(e[n],t))},µ.util.sumArrays=function(e,t){return d3.zip(e,t).map(function(e){return d3.sum(e)})},µ.util.arrayLast=function(e){return e[e.length-1]},µ.util.arrayEqual=function(e,t){for(var n=Math.max(e.length,t.length,1);n-->=0&&e[n]===t[n];);return-2===n},µ.util.flattenArray=function(e){for(var t=[];!µ.util.arrayEqual(t,e);)t=e,e=[].concat.apply([],e);return e},µ.util.deduplicate=function(e){return e.filter(function(e,t,n){return n.indexOf(e)==t})},µ.util.convertToCartesian=function(e,t){var n=t*Math.PI/180,r=e*Math.cos(n),a=e*Math.sin(n);return[r,a]},µ.util.round=function(e,t){var n=t||2,r=Math.pow(10,n);return Math.round(e*r)/r},µ.util.getMousePos=function(e){var t=d3.mouse(e.node()),n=t[0],r=t[1],a={};return a.x=n,a.y=r,a.pos=t,a.angle=180*(Math.atan2(r,n)+Math.PI)/Math.PI,a.radius=Math.sqrt(n*n+r*r),a},µ.util.duplicatesCount=function(e){for(var t,n={},r={},a=0,i=e.length;i>a;a++)t=e[a],t in n?(n[t]++,r[t]=n[t]):n[t]=1;return r},µ.util.duplicates=function(e){return Object.keys(µ.util.duplicatesCount(e))},µ.PolyChart=function(){function e(){var e=n.geometryConfig,r=e.container;"string"==typeof r&&(r=d3.select(r)),r.datum(n.data).each(function(n){function r(t){var n=e.radialScale(t[1]),r=(e.angularScale(t[0])+e.originTheta)*Math.PI/180;return{r:n,θ:r}}function i(e){var t=e.r*Math.cos(e.θ),n=e.r*Math.sin(e.θ);return{x:t,y:n}}var o=!!n.yStack,l=n.y.map(function(e,t){return o?d3.zip(n.x[0],e,n.yStack[t]):d3.zip(n.x[0],e)}),u=e.angularScale,s=e.angularScale.copy().range(e.angularScale.range().slice().reverse()),c=e.flip?u:s,d={},f=e.radialScale.domain()[0];d.bar=function(t){var n=e.radialScale(t[1]),r=e.radialScale(f+(t[2]||0));e.barRadialOffset&&(r=190,n-=r);var a=e.barWidth;return"M"+[[n+r,-a/2],[n+r,a/2],[r,a/2],[r,-a/2]].join("L")+"Z"},d.dot=function(t,n){return d3.svg.symbol().size(e.dotSize).type(e.dotType)(t,n)},d.arc=d3.svg.arc().startAngle(function(){return-g+Math.PI/2}).endAngle(function(){return g+Math.PI/2}).innerRadius(function(t){return e.radialScale(f+(t[2]||0))}).outerRadius(function(t){return e.radialScale(f+(t[2]||0))+e.radialScale(t[1])}),t=function(t){return[].concat(e.color)[t]};var g=c(l[0][1][0])*Math.PI/180/2,p={fill:function(e,n,r){return t(r)},stroke:e.strokeColor,"stroke-width":e.lineStrokeSize+"px","stroke-dasharray":a[e.dash],opacity:e.opacity,display:e.visible?"block":"none"},y=d3.select(this).classed("stacked-area-chart",!0),m=y.selectAll("g.layer").data(l);m.enter().append("g").classed("layer",!0);var h=m.selectAll("path.mark").data(function(e){return e});h.enter().append("path").attr({"class":"mark"}),h.attr({d:d[e.geometryType],transform:"dot"===e.geometryType?function(e){var t=i(r(e));return"translate("+[t.x,t.y]+")"}:function(t){return"rotate("+(e.originTheta+u(t[0]))+")"}}).style(p)})}var t,n=µ.PolyChart.defaultConfig(),r=d3.dispatch("hover"),a={solid:"none",dash:[5,2],dot:[2,5]};return e.config=function(e){if(!arguments.length)return n;var t=e;return Array.isArray(e)&&(t=e[0],t.data.y=e.map(function(e){return e.data.y[0]}),t.data.yStack=e.map(function(e){return e.data.yStack[0]}),t.geometryConfig.color=e.map(function(e){return e.geometryConfig.color})),µ.util.deepExtend(n,t),this},e.getColorScale=function(){return t},d3.rebind(e,r,"on"),e},µ.PolyChart.defaultConfig=function(){var e={data:{name:"geom1",x:[[1,2,3,4]],y:[[1,2,3,4]]},geometryConfig:{geometry:"LinePlot",geometryType:"arc",dotType:"circle",dotSize:64,barRadialOffset:null,barWidth:20,color:"#ffa500",strokeColor:"silver",dash:"solid",lineStrokeSize:1,flip:!0,originTheta:0,container:"body",opacity:1,radialScale:null,angularScale:null,index:0,visible:!0,visibleInLegend:!0,colorScale:d3.scale.category20()}};return e},µ.BarChart=function(){return µ.PolyChart()},µ.BarChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"bar"}};return e},µ.AreaChart=function(){return µ.PolyChart()},µ.AreaChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"arc"}};return e},µ.DotPlot=function(){return µ.PolyChart()},µ.DotPlot.defaultConfig=function(){var e={geometryConfig:{geometryType:"dot",dotType:"circle"}};return e},µ.LinePlot=function(){function e(){var e=t.geometryConfig,n=e.container;"string"==typeof n&&(n=d3.select(n)),n.datum(t.data).each(function(t){var n=d3.zip(t.x[0],t.y[0]),a=d3.svg.line.radial().interpolate(e.lineInterpolation).radius(function(t){return e.radialScale(t[1])}).angle(function(t){return e.angularScale(t[0])*Math.PI/180}),i={fill:"none","stroke-width":e.lineStrokeSize,stroke:e.color,"pointer-events":"stroke"},o=d3.select(this).classed("line-plot",!0),l=o.selectAll("path.mark").data([0]);l.enter().append("path").attr({"class":"mark"}),o.select("path.mark").datum(n).attr({d:a,transform:"rotate("+(e.originTheta+90)+")","stroke-width":e.lineStrokeSize+"px","stroke-dasharray":r[e.dash],opacity:e.opacity,display:e.visible?"block":"none"}).style(i)})}var t=µ.LinePlot.defaultConfig(),n=d3.dispatch("hover"),r={solid:"none",dash:[5,2],dot:[2,5]};return e.config=function(e){return arguments.length?(µ.util.deepExtend(t,e),this):t},d3.rebind(e,n,"on"),e},µ.LinePlot.defaultConfig=function(){var e={data:{name:"geom1",x:[[1,2,3,4]],y:[[1,2,3,4]]},geometryConfig:{geometry:"LinePlot",color:"#ffa500",dash:"solid",lineStrokeSize:2,lineInterpolation:"linear",flip:!0,originTheta:0,container:"body",opacity:1,radialScale:null,angularScale:null,index:0,visible:!0,visibleInLegend:!0}};return e},µ.Legend=function(){function e(){var n=t.legendConfig,r=t.data.map(function(e,t){return[].concat(e).map(function(e,r){var a=µ.util.deepExtend({},n.elements[t]);return a.name=e,a.color=[].concat(n.elements[t].color)[r],a})}),a=d3.merge(r);a=a.filter(function(e,t){return n.elements[t]&&(n.elements[t].visibleInLegend||"undefined"==typeof n.elements[t].visibleInLegend)}),n.reverseOrder&&(a=a.reverse());var i=n.container;("string"==typeof i||i.nodeName)&&(i=d3.select(i));var o=a.map(function(e){return e.color}),l=n.fontSize,u=null==n.isContinuous?"number"==typeof a[0]:n.isContinuous,s=u?n.height:l*a.length,c=i.classed("legend-group",!0),d=c.selectAll("svg").data([0]),f=d.enter().append("svg").attr({width:300,height:s+l,xmlns:"http://www.w3.org/2000/svg","xmlns:xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});f.append("g").classed("legend-axis",!0),f.append("g").classed("legend-marks",!0);var g=d3.range(a.length),p=d3.scale[u?"linear":"ordinal"]().domain(g).range(o),y=d3.scale[u?"linear":"ordinal"]().domain(g)[u?"range":"rangePoints"]([0,s]),m=function(e,t){var n=3*t;return"line"===e?"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z":-1!=d3.svg.symbolTypes.indexOf(e)?d3.svg.symbol().type(e).size(n)():d3.svg.symbol().type("square").size(n)()};if(u){var h=d.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(o);h.enter().append("stop"),h.attr({offset:function(e,t){return 100*(t/(o.length-1))+"%"}}).style({"stop-color":function(e){return e}}),d.append("rect").classed("legend-mark",!0).attr({height:n.height,width:n.colorBandWidth,fill:"url(#grad1)"})}else{var v=d.select(".legend-marks").selectAll("path.legend-mark").data(a);v.enter().append("path").classed("legend-mark",!0),v.attr({transform:function(e,t){return"translate("+[l/2,y(t)+l/2]+")"},d:function(e){var t=e.symbol;return m(t,l)},fill:function(e,t){return p(t)}}),v.exit().remove()}var k=d3.svg.axis().scale(y).orient("right"),x=d.select("g.legend-axis").attr({transform:"translate("+[u?n.colorBandWidth:l,l/2]+")"}).call(k);return x.selectAll(".domain").style({fill:"none",stroke:"none"}),x.selectAll("line").style({fill:"none",stroke:u?n.textColor:"none"}),x.selectAll("text").style({fill:n.textColor,"font-size":n.fontSize}).text(function(e,t){return a[t].name}),e}var t=µ.Legend.defaultConfig(),n=d3.dispatch("hover");return e.config=function(e){return arguments.length?(µ.util.deepExtend(t,e),this):t},d3.rebind(e,n,"on"),e},µ.Legend.defaultConfig=function(){var e={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}};return e},µ.tooltipPanel=function(){var e,t,n,r,a={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},i="tooltip-"+µ.tooltipPanel.uid++,o=function(){e=a.container.selectAll("g."+i).data([0]);var l=e.enter().append("g").classed(i,!0).style({"pointer-events":"none"});return r=l.append("circle").attr({cx:5,r:5}).style({fill:"white","fill-opacity":.9}),n=l.append("rect").style({fill:"white","fill-opacity":.9}),t=l.append("text").attr({dy:.3*-a.fontSize,dx:a.padding+5}),o};return o.text=function(i){var l=d3.hsl(a.color).l,u=l>=.5?"#aaa":"white",s=l>=.5?"black":"white",c=i||"";t.style({fill:s,"font-size":a.fontSize+"px"}).text(c);var d=a.padding,f=t.node().getBBox();return n.attr({x:5,y:-(f.height+d),width:f.width+2*d,height:f.height+2*d,rx:0,ry:0}).style({fill:a.color,stroke:u,"stroke-width":"2px"}),r.attr({cy:-(f.height/2)}).style({display:a.hasTick?"block":"none"}),e.style({display:"block"}),o},o.move=function(t){return e?(e.attr({transform:"translate("+[t[0],t[1]]+")"}).style({display:"block"}),o):void 0},o.hide=function(){return e?(e.style({display:"none"}),o):void 0},o.show=function(){return e?(e.style({display:"block"}),o):void 0},o.config=function(e){return µ.util.deepExtend(a,e),o},o},µ.tooltipPanel.uid=1,µ.adapter={},µ.adapter.plotly=function(){var e={};return e.convert=function(e){var t={},n={};if(e.data&&(t.data=e.data.slice(),t.geometryConfig=t.data.map(function(e){return n={},e.type&&(n.geometry=e.type.substr("Polar".length)),e.line&&e.line.color&&(n.color=e.line.color),e.line&&e.line.width&&(n.lineStrokeSize=e.line.width),e.line&&e.line.dash&&(n.dash=e.line.dash),e.line&&e.line.interpolation&&(n.lineInterpolation=e.line.interpolation),e.opacity&&(n.opacity=e.opacity),"undefined"!=typeof e.visible&&(n.visible=e.visible),"undefined"!=typeof e.visibleInLegend&&(n.visibleInLegend=e.visibleInLegend),e.marker&&e.marker.type&&(n.dotType=e.marker.type),e.marker&&e.marker.color&&(n.color=e.marker.color),e.marker&&e.marker.line&&e.marker.line.color&&(n.strokeColor=e.marker.line.color),e.marker&&e.marker.size&&(n.dotSize=e.marker.size),e.marker&&"undefined"!=typeof e.marker.barRadialOffset&&(n.barRadialOffset=e.marker.barRadialOffset),e.marker&&"undefined"!=typeof e.marker.barWidth&&(n.barWidth=e.marker.barWidth),n}),e.layout&&"stack"===e.layout.barmode)){var r=µ.util.duplicates(t.data.map(function(e){return e.type}));t.data.forEach(function(e,n){var a=r.indexOf(e.type);-1!=a&&(t.geometryConfig[n].groupId=a)})}return e.layout&&(t.legendConfig={},n={},d3.entries(e.layout).forEach(function(e){if("height"===e.key&&(n.height=e.value),"width"===e.key&&(n.width=e.value),"title"===e.key&&(n.title=e.value),"showlegend"===e.key&&(t.legendConfig.showLegend=e.value),"direction"===e.key&&(n.flip="clockwise"===e.value),"needsEndSpacing"===e.key&&(n.needsEndSpacing=e.value),"legend"===e.key&&e.value.traceorder&&(t.legendConfig.reverseOrder="reversed"===e.value.traceorder),"plot_bgcolor"===e.key&&(n.backgroundColor=e.value),"xaxis"===e.key&&("undefined"!=typeof e.value.range&&(n.angularDomain=e.value.range),"undefined"!=typeof e.value.tickCount&&(n.angularTicksCount=e.value.tickCount),"undefined"!=typeof e.value.tickStep&&(n.angularTicksStep=e.value.tickStep),"undefined"!=typeof e.value.minorTickCount&&(n.minorTicks=e.value.minorTickCount),e.value.suffix&&(n.angularTicksSuffix=e.value.suffix),"undefined"!=typeof e.value.flip&&(n.flip=e.value.flip),"undefined"!=typeof e.value.rewriteTicks&&(n.angularRewriteTicks=e.value.rewriteTicks)),"yaxis"===e.key&&("undefined"!=typeof e.value.range&&(n.radialDomain=e.value.range),e.value.suffix&&(n.radialTicksSuffix=e.value.suffix),"undefined"!=typeof e.value.orientation&&(n.radialAxisTheta=e.value.orientation),"undefined"!=typeof e.value.rewriteTicks&&(n.radialRewriteTicks=e.value.rewriteTicks),"undefined"!=typeof e.value.labelOffset&&(n.labelOffset=e.value.labelOffset)),"font"===e.key&&(e.value.size&&(n.fontSize=e.value.size),e.value.color&&(n.fontColor=e.value.color),e.value.family&&(n.fontFamily=e.value.family)),"margin"===e.key){var r=["t","r","b","l","pad"],a=["top","right","bottom","left","pad"];n.margin={},d3.entries(e.value).forEach(function(e){n.margin[a[r.indexOf(e.key)]]=e.value})}"orientation"===e.key&&(n.originTheta=e.value),"tickColor"===e.key&&(n.tickColor=e.value),"minorTickColor"===e.key&&(n.minorTickColor=e.value)}),t.axisConfig=n,e.container&&(t.axisConfig.container=e.container)),t},e};